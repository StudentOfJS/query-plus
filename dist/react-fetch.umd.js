(function(n,e){typeof exports=="object"&&typeof module!="undefined"?e(exports,require("react")):typeof define=="function"&&define.amd?define(["exports","react"],e):(n=typeof globalThis!="undefined"?globalThis:n||self,e(n.MyLib={},n.React))})(this,function(n,e){"use strict";var Y=Object.defineProperty,B=Object.defineProperties;var J=Object.getOwnPropertyDescriptors;var h=Object.getOwnPropertySymbols;var v=Object.prototype.hasOwnProperty,U=Object.prototype.propertyIsEnumerable;var w=(n,e,o)=>e in n?Y(n,e,{enumerable:!0,configurable:!0,writable:!0,value:o}):n[e]=o,c=(n,e)=>{for(var o in e||(e={}))v.call(e,o)&&w(n,o,e[o]);if(h)for(var o of h(e))U.call(e,o)&&w(n,o,e[o]);return n},p=(n,e)=>B(n,J(e));const o="dmFyIHU9T2JqZWN0LmRlZmluZVByb3BlcnR5LGg9T2JqZWN0LmRlZmluZVByb3BlcnRpZXM7dmFyIGc9T2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcnM7dmFyIG49T2JqZWN0LmdldE93blByb3BlcnR5U3ltYm9sczt2YXIgZD1PYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LHc9T2JqZWN0LnByb3RvdHlwZS5wcm9wZXJ0eUlzRW51bWVyYWJsZTt2YXIgbD0ocyx0LGUpPT50IGluIHM/dShzLHQse2VudW1lcmFibGU6ITAsY29uZmlndXJhYmxlOiEwLHdyaXRhYmxlOiEwLHZhbHVlOmV9KTpzW3RdPWUsYz0ocyx0KT0+e2Zvcih2YXIgZSBpbiB0fHwodD17fSkpZC5jYWxsKHQsZSkmJmwocyxlLHRbZV0pO2lmKG4pZm9yKHZhciBlIG9mIG4odCkpdy5jYWxsKHQsZSkmJmwocyxlLHRbZV0pO3JldHVybiBzfSxpPShzLHQpPT5oKHMsZyh0KSk7KGZ1bmN0aW9uKCl7InVzZSBzdHJpY3QiO3NlbGYuYWRkRXZlbnRMaXN0ZW5lcigibWVzc2FnZSIscz0+e2NvbnN0e3R5cGU6dH09cy5kYXRhO2xldCBlPW5ldyBBYm9ydENvbnRyb2xsZXIsYT1lLnNpZ25hbDtpZih0PT09ImNhbmNlbCImJmUuc2lnbmFsLmFib3J0KCksdD09PSJmZXRjaCIpe2NvbnN0e3VybDpmLG9wdGlvbnM6b309cy5kYXRhO2ZldGNoKGYsbz9pKGMoe30sbykse3NpZ25hbDphfSk6e3NpZ25hbDphfSkudGhlbihyPT57aWYoIXIub2t8fHIuc3RhdHVzPT09NDA0KXRocm93IG5ldyBFcnJvcihgSFRUUCBlcnJvciEgU3RhdHVzOiAke3Iuc3RhdHVzfWApO2lmKHIuc3RhdHVzPT09NDAzKXRocm93IG5ldyBFcnJvcigiVW5hdXRob3JpemVkISIpO3JldHVybiByLmpzb24oKX0pLnRoZW4ocj0+e3NlbGYucG9zdE1lc3NhZ2Uoe3R5cGU6InN1Y2Nlc3MiLGRhdGE6cn0pLGU9dm9pZCAwfSkuY2F0Y2gocj0+e3NlbGYucG9zdE1lc3NhZ2Uoe3R5cGU6ci5tZXNzYWdlfHwiVW5rbm93biBlcnJvciJ9KX0pfX0pfSkoKTsK",Z=typeof window!="undefined"&&window.Blob&&new Blob([atob(o)],{type:"text/javascript;charset=utf-8"});function g(){const t=Z&&(window.URL||window.webkitURL).createObjectURL(Z);try{return t?new Worker(t,{}):new Worker("data:application/javascript;base64,"+o,{type:"module"})}finally{t&&(window.URL||window.webkitURL).revokeObjectURL(t)}}const G=24*60*60*1e3;function u(t){t==null||t.postMessage({type:"cancel"}),t==null||t.terminate(),t=void 0}function H(t,i){switch(i.type){case"data":return p(c({},t),{data:i.data,loading:!1,error:void 0});case"clearError":return p(c({},t),{error:void 0});case"error":return p(c({},t),{error:i.error,loading:!1});case"loading":return p(c({},t),{loading:i.loading});default:return t}}const L={data:void 0,error:void 0,loading:!1,update:!0};function S(){const[t,i]=e.useReducer(H,L),s=e.useRef({worker:void 0,controller:new AbortController});let{worker:l,controller:y}=s.current;return e.useEffect(()=>{var d,a,r;return!window&&!((r=(a=(d=s==null?void 0:s.current)==null?void 0:d.controller)==null?void 0:a.signal)!=null&&r.aborted)&&(i({type:"loading",loading:!1}),i({type:"error",error:new Error("window is not defined")}),u(l)),()=>{u(l)}},[window,s.current.controller]),c({fetchWorker:({url:d,options:a,cache:r=!1,maxAge:W=G})=>{u(l);let R=!r;if(r){let b=sessionStorage.getItem(d.toString());if(b){let{data:m,timestamp:f}=JSON.parse(b);f+W>Date.now()?i({type:"data",data:m}):R=!0}else R=!0}window&&R&&(sessionStorage.removeItem(d.toString()),l=new g,i({type:"loading",loading:!0}),l.postMessage({type:"fetch",url:d,options:a}),l.addEventListener("message",({data:{data:b,type:m}})=>{var f;if(!((f=y==null?void 0:y.signal)!=null&&f.aborted))switch(m){case"success":if(r){let I={timestamp:Date.now(),data:b},N=JSON.stringify(I);sessionStorage.setItem(d.toString(),N)}i({type:"data",data:b,url:d,options:a});break;default:i({type:"error",error:new Error(m)});break}u(l)}))}},t)}n.useFetchHook=S,Object.defineProperties(n,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})});
