(function(l,d){typeof exports=="object"&&typeof module!="undefined"?d(exports,require("react"),require("idb-keyval")):typeof define=="function"&&define.amd?define(["exports","react","idb-keyval"],d):(l=typeof globalThis!="undefined"?globalThis:l||self,d(l.queryPlus={},l.React))})(this,function(l,d){"use strict";const a="KGZ1bmN0aW9uKCl7InVzZSBzdHJpY3QiO2Z1bmN0aW9uIHAodCl7cmV0dXJuIG5ldyBQcm9taXNlKChlLG4pPT57dC5vbmNvbXBsZXRlPXQub25zdWNjZXNzPSgpPT5lKHQucmVzdWx0KSx0Lm9uYWJvcnQ9dC5vbmVycm9yPSgpPT5uKHQuZXJyb3IpfSl9ZnVuY3Rpb24gVCh0LGUpe2NvbnN0IG49aW5kZXhlZERCLm9wZW4odCk7bi5vbnVwZ3JhZGVuZWVkZWQ9KCk9Pm4ucmVzdWx0LmNyZWF0ZU9iamVjdFN0b3JlKGUpO2NvbnN0IHI9cChuKTtyZXR1cm4oYSxjKT0+ci50aGVuKG89PmMoby50cmFuc2FjdGlvbihlLGEpLm9iamVjdFN0b3JlKGUpKSl9bGV0IG07ZnVuY3Rpb24gRCgpe3JldHVybiBtfHwobT1UKCJrZXl2YWwtc3RvcmUiLCJrZXl2YWwiKSksbX1mdW5jdGlvbiBHKHQsZT1EKCkpe3JldHVybiBlKCJyZWFkb25seSIsbj0+cChuLmdldCh0KSkpfWZ1bmN0aW9uIFIodCxlLG49RCgpKXtyZXR1cm4gbigicmVhZHdyaXRlIixyPT4oci5wdXQoZSx0KSxwKHIudHJhbnNhY3Rpb24pKSl9ZnVuY3Rpb24gVSh0LGUsbj1EKCkpe3JldHVybiBuKCJyZWFkd3JpdGUiLHI9Pm5ldyBQcm9taXNlKChhLGMpPT57ci5nZXQodCkub25zdWNjZXNzPWZ1bmN0aW9uKCl7dHJ5e3IucHV0KGUodGhpcy5yZXN1bHQpLHQpLGEocChyLnRyYW5zYWN0aW9uKSl9Y2F0Y2gobyl7YyhvKX19fSkpfWZ1bmN0aW9uIHgodCxlPUQoKSl7cmV0dXJuIGUoInJlYWR3cml0ZSIsbj0+KG4uZGVsZXRlKHQpLHAobi50cmFuc2FjdGlvbikpKX1mdW5jdGlvbiBOKCl7Y29uc3Qgbj1UKCJ1c2VzdG9yZS1kYiIsInVzZXN0b3JlLWRiIik7cmV0dXJue3JlbW92ZTppPT54KGksbiksZ2V0RGF0YTppPT5HKGksbiksc2V0RGF0YTooaSxoKT0+UihpLGgsbiksdXBkYXRlRGF0YTooaSxoKT0+VShpLGgsbil9fWNvbnN0IF89KHQsZSk9PmU/dCtlPERhdGUubm93KCk6ITAsQT10PT50eXBlb2YgdD09Im9iamVjdCImJiFBcnJheS5pc0FycmF5KHQpJiZ0IT09bnVsbCxFPSh0LGUsbj17fSk9PihPYmplY3Qua2V5cyh0KS5mb3JFYWNoKHI9PntsZXQgYT1lP2UrIi4iK3I6cjtBKHRbcl0pP0UodFtyXSxhLG4pOm5bYV09QXJyYXkuaXNBcnJheSh0W3JdKT90W3JdLnNvcnQoKTp0W3JdfSksT2JqZWN0LmVudHJpZXMobikuc29ydCgpKSxPPXQ9PnQuZmxhdE1hcChlPT5BKGUpP0UoZSk6W2VdKS5zb3J0KCksST10PT57dmFyIGUsbjtyZXR1cm4obj0oZT10PT1udWxsP3ZvaWQgMDp0Lm1ldGhvZCk9PW51bGw/dm9pZCAwOmUudG9VcHBlckNhc2UoKSkhPW51bGw/bjoiR0VUIn0sQz0odCxlLG4pPT57bGV0IHI9QXJyYXkuaXNBcnJheSh0KT8iYXJyYXkiOnR5cGVvZiB0LGE9QXJyYXkuaXNBcnJheShlKT8iYXJyYXkiOnR5cGVvZiBlO3JldHVybiByIT09YT8hMTpyIT09Im9iamVjdCImJnIhPT0iYXJyYXkiP3I9PT1hOm4mJnI9PT0ib2JqZWN0Ij9uLm1hcChjPT50W2NdPT09ZVtjXSkuZXZlcnkoYz0+Yyk6KHI9PT0iYXJyYXkiJiYodD1PKHQpLGU9TyhlKSksIW4mJnI9PT0ib2JqZWN0IiYmKHQ9RSh0KSxlPUUoZSkpLEpTT04uc3RyaW5naWZ5KHQpPT09SlNPTi5zdHJpbmdpZnkoZSkpfSxMPXQ9PnQ/bmV3IEZ1bmN0aW9uKGByZXR1cm4gJHtkZWNvZGVVUkkodCl9YCkoKTplPT5lLHtyZW1vdmU6UCxnZXREYXRhOiQsc2V0RGF0YTpCLHVwZGF0ZURhdGE6Rn09TigpLGc9dD0+e2lmKCF0Lm9rfHx0LnN0YXR1cz09PTQwNCl0aHJvdyBuZXcgRXJyb3IoYEhUVFAgZXJyb3IhIFN0YXR1czogJHt0LnN0YXR1c31gKTtpZih0LnN0YXR1cz09PTQwMyl0aHJvdyBuZXcgRXJyb3IoIjQwMyBVbmF1dGhvcml6ZWQiKTtyZXR1cm4gdC5qc29uKCl9LFM9dD0+e3NlbGYucG9zdE1lc3NhZ2Uoe3R5cGU6dC5tZXNzYWdlfHwiVW5rbm93biBlcnJvciJ9KX07c2VsZi5hZGRFdmVudExpc3RlbmVyKCJtZXNzYWdlIixhc3luYyB0PT57aWYodC5pc1RydXN0ZWQpe2NvbnN0e3R5cGU6ZX09dC5kYXRhO2xldCBuPW5ldyBBYm9ydENvbnRyb2xsZXIscj1uPT1udWxsP3ZvaWQgMDpuLnNpZ25hbDtpZihlPT09ImNhbmNlbCImJihuPT1udWxsfHxuLmFib3J0KCkpLGU9PT0icHJlLWZldGNoIil7bGV0e3ByZWZldGNoOmF9PXQuZGF0YTthLmZvckVhY2goKHttaWRkbGV3YXJlOmMsdXJsOm8sb3B0aW9uczppLG1heEFnZTpofSk9PntsZXQgTT1MKGMpO2ZldGNoKG8udG9TdHJpbmcoKSx7c2lnbmFsOnIsLi4uaX0pLnRoZW4oZykudGhlbihkPT57QihvLnRvU3RyaW5nKCkse3RpbWVzdGFtcDpEYXRlLm5vdygpLGRhdGE6TShkKSxtYXhBZ2U6aH0pLnRoZW4oKCk9Pntjb25zb2xlLmxvZyhgc2F2ZWQgcHJlZmV0Y2ggJHtvfWApfSkuY2F0Y2godT0+e2NvbnNvbGUubG9nKGBlcnJvciBzYXZpbmcgcHJlZmV0Y2ggJHtvfWAsdSl9KX0pLmNhdGNoKCgpPT57Y29uc29sZS5pbmZvKCJubyBkYXRhIGZvdW5kIil9KX0pfWlmKGU9PT0iZmV0Y2giKXtsZXR7ZXhpc3RpbmdEYXRhOmEscHJlZmVyVXNlQ2FjaGU6Yyx1cmw6byxvcHRpb25zOmksbWF4QWdlOmgsbWlkZGxld2FyZTpNLHVwZGF0ZTpkfT10LmRhdGE7Y29uc3QgdT1mPT57Zj1MKE0pKGYpLCghYXx8IUMoYSxmKSkmJihzZWxmLnBvc3RNZXNzYWdlKHt0eXBlOiJEQVRBIixkYXRhOmZ9KSxCKG8udG9TdHJpbmcoKSx7ZGF0YTpmLHRpbWVzdGFtcDpEYXRlLm5vdygpLG1heEFnZTpofSkudGhlbigoKT0+e2NvbnNvbGUuaW5mbygic2F2ZWQgZGF0YSIpfSkuY2F0Y2goKCk9Pntjb25zb2xlLmluZm8oImNvdWxkbid0IGFjY2VzcyBpbmRleGVkREIgdG8gc2F2ZSBkYXRhIil9KSksc2VsZi5wb3N0TWVzc2FnZSh7dHlwZToiQ09NUExFVEUifSl9O2xldCBsPUkoaSk7aWYobD09PSJERUxFVEUiJiYoc2VsZi5wb3N0TWVzc2FnZSh7dHlwZToiTE9BRElORyJ9KSxQKG8udG9TdHJpbmcoKSksZmV0Y2gobyxpKS50aGVuKCgpPT57ZD9mZXRjaChkLnVybCxkLm9wdGlvbnMpLnRoZW4oZykudGhlbih1KS5jYXRjaChmPT57dGhyb3cgZn0pOnNlbGYucG9zdE1lc3NhZ2Uoe3R5cGU6IkNPTVBMRVRFIn0pfSkuY2F0Y2goUykpLGw9PT0iR0VUIil7bGV0IGY9YXdhaXQgJChvLnRvU3RyaW5nKCkpLnRoZW4ocz0+e2lmKCFzfHxfKHM9PW51bGw/dm9pZCAwOnMubWF4QWdlLHM9PW51bGw/dm9pZCAwOnMudGltZXN0YW1wKSlyZXR1cm4hcyYmY29uc29sZS5sb2coIm5vIHZhbHVlIGZvdW5kIikscyYmUChvLnRvU3RyaW5nKCkpLCEwO2xldCB5PUMocz09bnVsbD92b2lkIDA6cy5kYXRhLGEpLHc9e3R5cGU6Yz8iREFUQSI6eT8iQ0FDSEVEIjoiUFJFX0xPQUQiLGRhdGE6IWMmJnl8fHM9PW51bGw/dm9pZCAwOnMuZGF0YX07cmV0dXJuIHNlbGYucG9zdE1lc3NhZ2UodyksITF9KS5jYXRjaChzPT57Y29uc29sZS5pbmZvKHM9PW51bGw/dm9pZCAwOnMubWVzc2FnZSksYz0hMX0pOyghY3x8ZikmJihzZWxmLnBvc3RNZXNzYWdlKHt0eXBlOiJMT0FESU5HIn0pLGZldGNoKG8saT97Li4uaSxzaWduYWw6cn06e3NpZ25hbDpyfSkudGhlbihnKS50aGVuKHUpLmNhdGNoKFMpKX0obD09PSJQVVQifHxsPT09IlBPU1QiKSYmKHNlbGYucG9zdE1lc3NhZ2Uoe3R5cGU6IkxPQURJTkcifSksZmV0Y2gobyxpP3suLi5pLHNpZ25hbDpyfTp7c2lnbmFsOnJ9KS50aGVuKGcpLnRoZW4oZj0+e2Q/ZmV0Y2goZC51cmwsZC5vcHRpb25zKS50aGVuKGcpLnRoZW4odSkuY2F0Y2gocz0+e3Rocm93IHN9KTpGKG8udG9TdHJpbmcoKSxzPT57bGV0IHk9RGF0ZS5ub3coKSx3PUEoZikmJkEocz09bnVsbD92b2lkIDA6cy5kYXRhKT97Li4ucy5kYXRhLC4uLmZ9OmY7cmV0dXJuIHNlbGYucG9zdE1lc3NhZ2Uoe3R5cGU6bCxkYXRhOnd9KSx7dGltZXN0YW1wOnksbWF4QWdlOmgsZGF0YTp3fX0pLmNhdGNoKCgpPT57Y29uc29sZS5pbmZvKCJ1cGRhdGUgc3RvcmUgZmFpbGVkIil9KS5maW5hbGx5KCgpPT57c2VsZi5wb3N0TWVzc2FnZSh7dHlwZToiQ09NUExFVEUifSl9KX0pLmNhdGNoKFMpKX19fSl9KSgpOwo=",K=typeof window!="undefined"&&window.Blob&&new Blob([atob(a)],{type:"text/javascript;charset=utf-8"});function h(){const e=K&&(window.URL||window.webkitURL).createObjectURL(K);try{return e?new Worker(e,{}):new Worker("data:application/javascript;base64,"+a,{type:"module"})}finally{e&&(window.URL||window.webkitURL).revokeObjectURL(e)}}const I={data:void 0,error:void 0,loading:!1,preload:!1,update:!0};function C(e,c){switch(c.type){case"pre-load":return{...e,data:c.data,loading:!1,preload:!0,error:void 0};case"data":return{...e,data:c.data,loading:!1,preload:!1,error:void 0};case"error":return{...e,error:c.error,loading:!1,preload:!1};case"loading":return{...e,loading:c.loading};default:return e}}const H=24*60*60*1e3;function v(e){e==null||e.postMessage({type:"cancel"}),e==null||e.terminate(),e=void 0}const Y=e=>e?encodeURI(e.toString()):void 0;function U(){const[e,c]=d.useReducer(C,I),o=d.useRef(),i=async({url:p,options:Z,maxAge:m=H,preferUseCache:G,middleware:n})=>{let t=o.current;t==null||t.addEventListener("message",({isTrusted:s,data:{type:u,data:b}})=>{if(s)switch(u){case"LOADING":c({type:"loading",loading:!0});break;case"CACHED":case"COMPLETE":c({type:"loading",loading:!1});break;case"DATA":c({type:"data",data:b});break;case"PRE_LOAD":c({type:"pre-load",data:b});break;default:c({type:"error",error:new Error(u)});break}}),t==null||t.postMessage({type:"fetch",url:p,options:Z,existingData:e.data,middleware:Y(n),maxAge:m,preferUseCache:G})};return d.useEffect(()=>(o.current=new h,()=>{v(o.current)}),[]),{fetchWorker:i,...e}}function X(e){const c=d.useRef(new h);d.useEffect(()=>{var o;e&&c.current&&((o=c.current)==null||o.postMessage({type:"pre-fetch",prefetch:e.map(i=>({...i,middleware:Y(i.middleware)}))}))},[e,c.current])}const F=({eventName:e,handler:c,options:o={}})=>{const i=d.useRef(),p=d.useRef(),{capture:Z,passive:m,once:G}=o,n=window.document.body;return d.useEffect(()=>{i.current=c},[c]),d.useEffect(()=>{if(!(n&&n.addEventListener))return;const s=r=>i.current&&i.current(r),u={capture:Z,passive:m,once:G};n.addEventListener(e,s,u);const b=()=>n.removeEventListener(e,s,u);return p.current=b,b},[e,n,Z,m,G]),[p.current]};function g({expandTarget:e=0,targetRef:c,prefetch:o,timeToExcecute:i=1e3}){const[p,Z]=d.useState(),[m,G]=d.useState(!1),n=d.useRef();X(p);const[t]=F({eventName:"mousemove",handler:({clientX:s,clientY:u})=>{var R,W,T,y,k,S,f,L,V,N,J,P;let b=((W=(R=c.current)==null?void 0:R.offsetLeft)!=null?W:0)-e,r=((y=(T=c.current)==null?void 0:T.offsetLeft)!=null?y:0)+((S=(k=c.current)==null?void 0:k.offsetWidth)!=null?S:0)+e,Q=((L=(f=c.current)==null?void 0:f.offsetTop)!=null?L:0)-e,x=((N=(V=c.current)==null?void 0:V.offsetTop)!=null?N:0)+((P=(J=c.current)==null?void 0:J.offsetHeight)!=null?P:0)+e;s>b&&s<r&&u>Q&&u<x?(console.info("in target area"),n.current||(n.current=setTimeout(()=>{Z(o),G(!0),t&&t()},i))):n.current&&(clearTimeout(n.current),n.current=void 0)},options:{passive:!0,once:m}});d.useEffect(()=>()=>{clearTimeout(n.current)},[])}l.useFetch=U,l.useIntent=g,l.usePreFetch=X,Object.defineProperties(l,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})});
